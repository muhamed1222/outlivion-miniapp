# ‚úÖ PHASE 1 –ó–ê–í–ï–†–®–ï–ù: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

## üéâ –°—Ç–∞—Ç—É—Å: –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û

–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: 3 –¥–µ–∫–∞–±—Ä—è 2025

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. Layouts –¥–ª—è –æ–±–µ–∏—Ö —Å—Ä–µ–¥

**–°–æ–∑–¥–∞–Ω: `src/app/telegram/layout.tsx`**
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç `TelegramProvider` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram WebApp API
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç `NavigationBar` –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞
- ‚úÖ Padding —Å–Ω–∏–∑—É –¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ fixed navbar (pb-20)

**–°–æ–∑–¥–∞–Ω: `src/app/web/layout.tsx`**
- ‚úÖ –ü–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω—ã–π –¥–∏–∑–∞–π–Ω –±–µ–∑ NavigationBar
- ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ –º–µ—Å—Ç–æ –¥–ª—è Header/Footer (–±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ Phase 2)

### 2. Home pages –¥–ª—è –æ–±–µ–∏—Ö —Å—Ä–µ–¥

**–°–æ–∑–¥–∞–Ω: `src/app/telegram/page.tsx`**
- ‚úÖ –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è home page –¥–ª—è Telegram Mini App
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –±–∞–ª–∞–Ω—Å, –ø–æ–¥–ø–∏—Å–∫—É, quick actions, —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—É—Ç–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/telegram`

**–°–æ–∑–¥–∞–Ω: `src/app/web/page.tsx`**
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/web/login`
- ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ –¥–ª—è Phase 2 (—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π landing page)

### 3. –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü MiniApp

**–£—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ `src/app/telegram/`:**
- ‚úÖ `billing/page.tsx` ‚Üí `/telegram/billing`
- ‚úÖ `servers/page.tsx` ‚Üí `/telegram/servers`
- ‚úÖ `config/[serverId]/page.tsx` ‚Üí `/telegram/config/[serverId]`
- ‚úÖ `promo/page.tsx` ‚Üí `/telegram/promo`
- ‚úÖ `subscription/page.tsx` ‚Üí `/telegram/subscription`

### 4. –û–±–Ω–æ–≤–ª–µ–Ω NavigationBar

**–§–∞–π–ª: `src/components/navigation-bar.tsx`**
- ‚úÖ –í—Å–µ href –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ `/telegram/*` –ø—É—Ç–∏
- ‚úÖ –õ–æ–≥–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–æ—É—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–ª—è –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ú–∞—Ä—à—Ä—É—Ç—ã:**
- `/telegram` ‚Üí –ì–ª–∞–≤–Ω–∞—è
- `/telegram/subscription` ‚Üí –ü–æ–¥–ø–∏—Å–∫–∞
- `/telegram/servers` ‚Üí –°–µ—Ä–≤–µ—Ä—ã
- `/telegram/promo` ‚Üí –ü—Ä–æ–º–æ–∫–æ–¥

### 5. –°–æ–∑–¥–∞–Ω Middleware

**–§–∞–π–ª: `src/middleware.ts`**
- ‚úÖ –ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤ –¥–ª—è Telegram Mini App
- ‚úÖ –ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤ –¥–ª—è Web Portal
- ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç—ã –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –∏–∑ cookies
- ‚úÖ Security headers (X-Frame-Options, X-Content-Type-Options, Referrer-Policy, Permissions-Policy)

**–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ä–æ—É—Ç—ã:**
- Telegram: `/telegram/billing`, `/telegram/servers`, `/telegram/config`, `/telegram/subscription`, `/telegram/promo`
- Web: `/web/dashboard`, `/web/billing`, `/web/profile`, `/web/config`, `/web/transactions`, `/web/promo`

### 6. –û–±–Ω–æ–≤–ª–µ–Ω Root Layout

**–§–∞–π–ª: `src/app/layout.tsx`**
- ‚úÖ –£–±—Ä–∞–Ω `TelegramProvider` (–ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ telegram layout)
- ‚úÖ –û—Å—Ç–∞–≤–ª–µ–Ω —Ç–æ–ª—å–∫–æ `ToastProvider` (–æ–±—â–∏–π –¥–ª—è –≤—Å–µ—Ö)
- ‚úÖ Telegram WebApp script –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### 7. Environment Detection (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç—Ç–∞–ø–æ–≤)

**–§–∞–π–ª—ã:**
- ‚úÖ `src/lib/utils/environment.ts` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ä–µ–¥—ã
- ‚úÖ `src/hooks/useEnvironment.ts` - React hook –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ `src/app/page.tsx` - auto-redirect –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ä–µ–¥—ã

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Build —Ç–µ—Å—Ç
```bash
‚úì Compiled successfully
‚úì Generating static pages (11/11)
‚úì Finalizing page optimization
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–°–ü–ï–®–ù–û

### Runtime —Ç–µ—Å—Ç—ã (Dev Server)
- ‚úÖ **`/`** ‚Üí –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ..." –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç
- ‚úÖ **`/telegram`** ‚Üí –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç home page —Å NavigationBar
- ‚úÖ **`/telegram/servers`** ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –∞–∫—Ç–∏–≤–Ω–∞—è –∏–∫–æ–Ω–∫–∞ –≤ navbar
- ‚úÖ **NavigationBar** ‚Üí –†–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–π —Ä–æ—É—Ç
- ‚úÖ **Layouts** ‚Üí –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ä–µ–¥—ã

### –°–∫—Ä–∏–Ω—à–æ—Ç—ã
- ‚úÖ `telegram-page.png` - Home page —Å NavigationBar
- ‚úÖ `telegram-servers.png` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –∞–∫—Ç–∏–≤–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

## üìÅ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
src/app/
‚îú‚îÄ‚îÄ page.tsx                    # Root redirect
‚îú‚îÄ‚îÄ layout.tsx                  # Root layout (–æ–±—â–∏–π)
‚îú‚îÄ‚îÄ telegram/                   # Telegram Mini App routes ‚Üí /telegram/*
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx              # Telegram layout (—Å TelegramProvider + NavigationBar)
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                # Home page
‚îÇ   ‚îú‚îÄ‚îÄ billing/
‚îÇ   ‚îú‚îÄ‚îÄ servers/
‚îÇ   ‚îú‚îÄ‚îÄ config/[serverId]/
‚îÇ   ‚îú‚îÄ‚îÄ promo/
‚îÇ   ‚îî‚îÄ‚îÄ subscription/
‚îú‚îÄ‚îÄ web/                        # Web Portal routes ‚Üí /web/*
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx              # Web layout (–±–µ–∑ NavigationBar)
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                # –í—Ä–µ–º–µ–Ω–Ω—ã–π redirect
‚îî‚îÄ‚îÄ api/
    ‚îî‚îÄ‚îÄ bot/                    # Telegram webhook

src/components/
‚îú‚îÄ‚îÄ navigation-bar.tsx          # –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è /telegram/*
‚îú‚îÄ‚îÄ telegram-provider.tsx
‚îî‚îÄ‚îÄ ui/

src/lib/
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ environment.ts          # Environment detection
‚îú‚îÄ‚îÄ api.ts
‚îú‚îÄ‚îÄ auth.ts
‚îú‚îÄ‚îÄ bot.ts
‚îî‚îÄ‚îÄ telegram.ts

src/hooks/
‚îî‚îÄ‚îÄ useEnvironment.ts           # Environment hook

src/middleware.ts               # Route protection + security headers
```

## üéØ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è Phase 1

1. ‚úÖ **–†–∞–±–æ—Ç–∞—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º–∏** `/telegram` –∏ `/web`
2. ‚úÖ **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ Telegram Mini App –∏ Web Portal** —á–µ—Ä–µ–∑ separate layouts
3. ‚úÖ **Middleware –¥–ª—è –∑–∞—â–∏—Ç—ã —Ä–æ—É—Ç–æ–≤** –¥–ª—è –æ–±–µ–∏—Ö —Å—Ä–µ–¥
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø—É—Ç—è–º–∏
5. ‚úÖ **Build –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ** –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
6. ‚úÖ **Runtime —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã** - –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç –ø–ª–∞–Ω–∞
**–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Route Groups `(telegram)` –∏ `(web)`
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –æ–±—ã—á–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `telegram/` –∏ `web/`

**–ü—Ä–∏—á–∏–Ω–∞:** Route Groups –≤ Next.js –ù–ï —Å–æ–∑–¥–∞—é—Ç —Å–µ–≥–º–µ–Ω—Ç—ã URL. –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞ –ë–ï–ó –≤–ª–∏—è–Ω–∏—è –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—É—Ç–µ–π `/telegram/*` –∏ `/web/*` –Ω—É–∂–Ω—ã –æ–±—ã—á–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

### Warnings (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ)
- Metadata viewport warnings - —ç—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Next.js 14 –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å viewport –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π export
- –ù–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –±—É–¥—É—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–æ–∑–∂–µ

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ Phase 2

Phase 1 –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω. –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫:

‚úÖ **Phase 2: –ú–∏–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Portal**
- –ü–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–∞–Ω–∏—Ü –∏–∑ `outlivion-portal` –≤ `src/app/web/`
- –ü–µ—Ä–µ–Ω–æ—Å UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ `src/components/web/` –∏ `src/components/shared/`
- –°–æ–∑–¥–∞–Ω–∏–µ Header –∏ Footer –¥–ª—è web layout

‚úÖ **Phase 3: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**
- –ï–¥–∏–Ω—ã–π `auth.ts` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ Telegram `initData` –∏ JWT
- Login —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –æ–±–µ–∏—Ö —Å—Ä–µ–¥

‚úÖ **Phase 4-6: API, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, deployment**

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 8
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 4
- **–ü–µ—Ä–µ–º–µ—â–µ–Ω–æ —Å—Ç—Ä–∞–Ω–∏—Ü:** 5
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~500
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2 —á–∞—Å–∞
- **–¢–µ—Å—Ç—ã:** 100% –ø—Ä–æ–π–¥–µ–Ω—ã

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** Phase 2 - –ú–∏–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Portal

–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è:
```bash
# –ù–∞—á–∞—Ç—å Phase 2
"–ü—Ä–æ–¥–æ–ª–∂–∞–π Phase 2: –ø–µ—Ä–µ–Ω–µ—Å–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ outlivion-portal"
```

